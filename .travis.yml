language: rust

matrix:
  - rust: nightly

cache:
  cargo: true

addons:
  apt:
    sources:
      - elasticsearch-2.x
    packages:
      - elasticsearch

services:
  - elasticsearch

script:
  - cargo test && cargo build --release

deploy:
  # merge in master => deploy it to staging
  #  - provider: heroku
  #    skip_cleanup: true
  #    api_key:
  #      secure: A+RuVKU65BPHkTVkKShKePxdrwgSRY2nebTdUqkL8tpYdw+JwUgsO8VusAqZhBY3mXFUhamwKYeJw9dyFw2+bpwbY+IQYzYqcs9/6532dQZWTNVJWo4GVLXULqeyYq/elmG+G6DWqF8+eLEtzosGXJOQgshnx3yweexa6alZis9MT+VXLYj8wW9J8iAAyu2RjeLOGD3q8LkNLT4j2apgtGGcS+aMtaZbEA9KhcqjjON47fpc4yTadOFiTgS5PCnxaehafXpjPC0NLKZD7o+06r7pR9ZXcJYHOHHwlgBOcbJMt5PCXh/hVfDCdMNL//yJaqLvrgx5K87MA/SYV6CrHn7oVwlYkIPHXkY2nQxgEjOWTBO6ppGAxB4aMmevHmiYafPrGt/lOM6+qFwfgYFDnwQlxry/iKBE98F0xnn65B94EmVD/0gFllHNg3xHaPRdg9UPxaEn+SMxPZb5Vldsp5TJNMn4jffy4nQGvGR8NLcl80nIgbM4mOLV59yAzg5Y2U2XTfCa9aHa3yPDecUlTy7JX3cM4gdRJ0L5ySpGRxh/H+3ikV0QIA6u9g4KcOlRGLYxpv3Pq7GMG+E1ekmioZCH+UqcCgj2GhcxiEsh7sJafLEzO1vyA1w+zmh3Wec4mI4Mj+j7zLEq3NV3t/Bm8fgSFiqaYgDCW7E3tO9ELys=
  #    app:
  #      master: staging-searchspot
  #    on:
  #      repo: honeypotio/searchspot
  #      branch: master
  #  # new tag => deploy master to release-staging and production
  #  - provider: heroku
  #    skip_cleanup: true
  #    api_key:
  #      secure: A+RuVKU65BPHkTVkKShKePxdrwgSRY2nebTdUqkL8tpYdw+JwUgsO8VusAqZhBY3mXFUhamwKYeJw9dyFw2+bpwbY+IQYzYqcs9/6532dQZWTNVJWo4GVLXULqeyYq/elmG+G6DWqF8+eLEtzosGXJOQgshnx3yweexa6alZis9MT+VXLYj8wW9J8iAAyu2RjeLOGD3q8LkNLT4j2apgtGGcS+aMtaZbEA9KhcqjjON47fpc4yTadOFiTgS5PCnxaehafXpjPC0NLKZD7o+06r7pR9ZXcJYHOHHwlgBOcbJMt5PCXh/hVfDCdMNL//yJaqLvrgx5K87MA/SYV6CrHn7oVwlYkIPHXkY2nQxgEjOWTBO6ppGAxB4aMmevHmiYafPrGt/lOM6+qFwfgYFDnwQlxry/iKBE98F0xnn65B94EmVD/0gFllHNg3xHaPRdg9UPxaEn+SMxPZb5Vldsp5TJNMn4jffy4nQGvGR8NLcl80nIgbM4mOLV59yAzg5Y2U2XTfCa9aHa3yPDecUlTy7JX3cM4gdRJ0L5ySpGRxh/H+3ikV0QIA6u9g4KcOlRGLYxpv3Pq7GMG+E1ekmioZCH+UqcCgj2GhcxiEsh7sJafLEzO1vyA1w+zmh3Wec4mI4Mj+j7zLEq3NV3t/Bm8fgSFiqaYgDCW7E3tO9ELys=
  #    app:
  #      master: production-searchspot
  #    on:
  #      repo: honeypotio/searchspot
  #      branch: master
  #      tags: true
  #  - provider: heroku
  #    skip_cleanup: true
  #    api_key:
  #      secure: A+RuVKU65BPHkTVkKShKePxdrwgSRY2nebTdUqkL8tpYdw+JwUgsO8VusAqZhBY3mXFUhamwKYeJw9dyFw2+bpwbY+IQYzYqcs9/6532dQZWTNVJWo4GVLXULqeyYq/elmG+G6DWqF8+eLEtzosGXJOQgshnx3yweexa6alZis9MT+VXLYj8wW9J8iAAyu2RjeLOGD3q8LkNLT4j2apgtGGcS+aMtaZbEA9KhcqjjON47fpc4yTadOFiTgS5PCnxaehafXpjPC0NLKZD7o+06r7pR9ZXcJYHOHHwlgBOcbJMt5PCXh/hVfDCdMNL//yJaqLvrgx5K87MA/SYV6CrHn7oVwlYkIPHXkY2nQxgEjOWTBO6ppGAxB4aMmevHmiYafPrGt/lOM6+qFwfgYFDnwQlxry/iKBE98F0xnn65B94EmVD/0gFllHNg3xHaPRdg9UPxaEn+SMxPZb5Vldsp5TJNMn4jffy4nQGvGR8NLcl80nIgbM4mOLV59yAzg5Y2U2XTfCa9aHa3yPDecUlTy7JX3cM4gdRJ0L5ySpGRxh/H+3ikV0QIA6u9g4KcOlRGLYxpv3Pq7GMG+E1ekmioZCH+UqcCgj2GhcxiEsh7sJafLEzO1vyA1w+zmh3Wec4mI4Mj+j7zLEq3NV3t/Bm8fgSFiqaYgDCW7E3tO9ELys=
  #    app:
  #      master: release-staging-searchspot
  #    on:
  #      repo: honeypotio/searchspot
  #      branch: master
  #      tags: true
  # test
  - provider: heroku
    skip_cleanup: true
    api_key:
      secure: WW1ufji+80soK3DYs+MamNT4MrUOuaVrVZLbIqgC2Xq5p936poFppbEXCgK9aBf/vmMcYpvhvuwdChHzcUEn16uSqpjYFIfM2mRoe3ijE8S+UdqdZFO/gIRoXTGanvr+aoOtL+wW94YGI6nL9OWFjCTjfHVnlJr4c+ScgaaT2O5mNd26yBYqBQVeVJwAoAvx8ufYUhsWi2aZ7MYjJk5Q1vb9FsXUENeKfy6ybyPdLo4KSGoLGiqfBdCAcygF8Hl/XYnndFSmPLHgJjtG/iQK+nfUXo6oXdGsWh5kKD/mMI8hhMwC4JsG5jCmlYzGRF9vDI0EmYAB5xq2qd977pfqo1iOdhGfoei0wUoH1qsCp7ZRyfvRb/CAEPgSTewKdrN5cvzjwssNH/iFFPNTVli5I9w5T+PCvth8TQ9ypQZqUnPHWPF/prIp2/E3MAOM7KyfP6WebuWDpMvqKAjTIbJNYFTm4uUJey6F171TvpAY9E5LNNqdF83DyoZP5tfx2immY1H+Mm5CN2dpjHn1TpZj0fRhalK+zQ/HiicLcCqmwo9pJ5ECRePfyIFI6wV2WdlkmwQ2nnFralFKn/zSJN0t8jl5yUczGqZeYnhlDSqumm75iKiNaOwtt1YAzK64fJqafZclRI2rdwo6+T+VUfdn+gybPyL0isrY/sAStLb+KeM=
    app: docker-searchspot
    on:
      repo: honeypotio/searchspot
      branch: travis-deploy
      tags: true
